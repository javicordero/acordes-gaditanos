---
interface Props {
  src: string;
  alt: string;
  loading?: 'lazy' | 'eager';
  class?: string;
  width?: number;
  height?: number;
  transitionName?: string;
}

const { src, alt, loading = 'lazy', class: className, width, height, transitionName } = Astro.props;

// Convertir URL de Blogger a WebP si es posible
// Blogger soporta conversi칩n autom치tica a침adiendo par치metros
const isBloggerImage = src.includes('blogger.googleusercontent.com');
const webpSrc = isBloggerImage ? `${src.split('=')[0]}=w${width || 800}-rw` : src;
const fallbackSrc = src;
---

<picture>
  {
    isBloggerImage ? (
      <>
        <source srcset={webpSrc} type='image/webp' />
        <img
          src={fallbackSrc}
          alt={alt}
          loading={loading}
          decoding='async'
          class={className}
          width={width}
          height={height}
          transition:name={transitionName}
        />
      </>
    ) : (
      <img
        src={src}
        alt={alt}
        loading={loading}
        decoding='async'
        class={className}
        width={width}
        height={height}
        transition:name={transitionName}
      />
    )
  }
</picture>

<style>
  picture {
    display: contents;
  }

  img {
    height: auto;
    max-width: 100%;
  }
</style>
